#!/bin/bash -x

./pull-binary-libs.sh

export ANT_OPTS="-Dfile.encoding=UTF-8 -server -XX:+AggressiveOpts -XX:+UseParNewGC -Xmx2G -Xss1M -XX:MaxPermSize=512M -XX:ReservedCodeCacheSize=128M"

# TODO: don't hardcode this path, which is just where we currently have
# ant manually installed on jenkins-worker-windows-publish.
PATH=/cygdrive/c/apache-ant-1.9.6/bin:$PATH

# TODO: don't hardcode here -- move to scala-jenkins-infra
export JAVA_HOME='c:/Program Files/Java/jdk1.8.0_92/'
export PATH="$JAVA_HOME/bin:$PATH"

ant -Dscalac.args.optimise=-Yopt test
